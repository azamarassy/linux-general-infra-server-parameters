# システムログ設定定義 (`/etc/rsyslog.conf`)

## 1. モジュール読み込み設定

ログ収集のエンジンとなるモジュールの動作定義です。

| モジュール | パラメータ | 説明 |
| --- | --- | --- |
| **imuxsock** | `SysSock.Use="off"` | ローカルシステムのログをサポート。imjournal経由でメッセージを取得するためローカルソケットを無効化。 |
| **imjournal** | `UsePid="system"`, `StateFile="imjournal.state"` | システムジャーナルを活用し、プロセスIDを識別。状態管理に必要なファイルを指定。 |

---

## 2. グローバル設定

システム全体のログ処理に関する基本設定です。

| 項目 | 設定値 | 説明 |
| --- | --- | --- |
| **workDirectory** | `/var/lib/rsyslog` | Rsyslogの補助ファイル（バッファや状態ファイル）を保存するディレクトリ。 |
| **テンプレート形式** | `RSYSLOG_TraditionalFileFormat` | 伝統的なタイムスタンプ形式（例: Oct 11 10:00:01）を使用。 |
| **インクルード** | `/etc/rsyslog.d/*.conf` | 外部設定ファイルをオプションとして読み込む設定。 |

---

## 3. ログ出力ルール

各メッセージの種類（ファシリティ）に応じた保存先の設定です。

| セレクタ (ファシリティ.レベル) | 出力先 | 説明 |
| --- | --- | --- |
| `*.info;mail.none;authpriv.none;cron.none` | `/var/log/messages` | 情報レベル以上の一般メッセージを記録（メール・認証・cronを除外）。 |
| `authpriv.*` | `/var/log/secure` | 認証およびセキュリティ関連のログを記録（アクセス制限付き）。 |
| `mail.*` | `-/var/log/maillog` | メール関連のログを記録。 |
| `cron.*` | `/var/log/cron` | cronジョブ（定期実行タスク）のログを記録。 |
| `*.emerg` | `:omusrmsg:*` | 全ユーザーに緊急メッセージを端末画面に一斉配信。 |
| `local7.*` | `/var/log/boot.log` | システムブート（起動）関連のログを記録。 |

---

### 補足事項

* **出力先のハイフン (`-`)**: `/var/log/maillog` の前にあるハイフンは、ログ書き込み時のディスク同期（Sync）を待機しないことを意味し、パフォーマンスを優先する設定です。
* **設定の反映**: 設定変更後は、`rsyslogd -N1` コマンドで構文チェックを行い、問題がなければ `systemctl restart rsyslog` で反映させてください。

